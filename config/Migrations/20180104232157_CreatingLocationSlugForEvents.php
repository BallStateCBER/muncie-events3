<?php// @codingStandardsIgnoreFileuse Migrations\AbstractMigration;class CreatingLocationSlugForEvents extends AbstractMigration{    /**     * Change Method.     *     * More information on this method is available here:     * http://docs.phinx.org/en/latest/migrations.html#the-change-method     * @return void     */    public function up()    {        $events = $this->table('events');        $events->changeColumn('location', 'string', ['limit' => 100]);        // clean up errors in inputting locations        $com = 'UPDATE events SET location=';        $del = 'Delaware County';        $loc = 'location_details';        $min = 'Minnetrista';        $mun = 'Muncie';        // locations around town        $this->execute('UPDATE events SET ' . $loc . '="Music Room", location="Cornerstone Center for the Arts" WHERE id="5"');        $this->execute($com . '"The Mark III Tap Room", address="306 S. Walnut St." WHERE id="1130" OR location="The Mark III Taproom"');        $this->execute($com . '"Northside Church of the Nazarene", address="3801 N. Wheeling Ave." WHERE id="4691"');        $this->execute($com . '"Be Here Now", address="505 N. Dill St." WHERE id="2853"');        $this->execute($com . '"Cornerstone Center for the Arts", address="520 E. Main St." WHERE id="4561"');        $this->execute($com . '"Lotus Yoga Studio", address="814 W. White River Blvd." WHERE id="4116"');        $this->execute($com . '"AMC Showplace ' . $mun . ' 12" WHERE id="3421"');        $this->execute($com . '"Ball Memorial Hospital", ' . $loc . '="Auditorium" WHERE id="30"');        $this->execute($com . '"Ball Memorial Hospital", ' . $loc . '="South Tower, John Fisher Heart Center lounge" WHERE id="2163"');        $this->execute($com . '"Big Shots Pub" WHERE id="3746"');        $this->execute($com . '"Blue Bottle Coffee Shop", ' . $loc . '="Parking Lot" WHERE id="559"');        $this->execute($com . '"Canan Commons", ' . $loc . '="Band Shell" WHERE location="Canan Commons Band Shell"');        $this->execute($com . '"Canan Commons" WHERE location like "Canan Commons%" OR location="Canon Commons"');        $this->execute($com . '"Cardinal Greenway Depot/Trail" WHERE location like "Cardinal Greenway Depot%" OR location="Cardinal Greenways, Wysor Street Depot" OR location="Historic Wysor St. Depot"');        $this->execute($com . '"Carnegie Public Library" WHERE location like "Carnegie Library%"');        $this->execute($com . '"Connection Corner" WHERE id="4362"');        $this->execute($com . '"Cornerstone Center for the Arts" WHERE id="89" OR id="4355"');        $this->execute($com . '"Cornerstone Park", ' . $loc . '="Corner of Main St. and Madison" WHERE id="3978"');        $this->execute($com . '"' . $del . ' Building" WHERE id="1175"');        $this->execute($com . '"' . $del . ' Fairgrounds", ' . $loc . '="Community Building" WHERE id="1563"');        $this->execute($com . '"' . $del . ' Fairgrounds", ' . $loc . '="Through DWNTWN" WHERE id="4169"');        $this->execute($com . '"' . $del . ' Fairgrounds", ' . $loc . '="Memorial Building" WHERE id="1693"');        $this->execute($com . '"' . $del . ' Fairgrounds" WHERE location="' . $del . ' Fair Grounds"');        $this->execute($com . '"Downtown", ' . $loc . '="Old National Lot" WHERE id="2291" OR id="3032" OR location="Downtown ' . $mun . '"');        $this->execute($com . '"Elm Street Brewing Company" WHERE location="Elm Street Brew Pub"');        $this->execute($com . '"Elm Street Brewing Company" WHERE location="Elm Street Brewing Company."');        $this->execute($com . '"Full Circle Arts Co-op" WHERE location like "Full Circle Arts Co-op%"');        $this->execute($com . '"Gallery 308" WHERE location="GALLERY 308"');        $this->execute($com . '"Gibson Roller Skating Arena" WHERE location like "Gibson%"');        $this->execute($com . '"Glick Center for Glass" WHERE location like "Glick%"');        $this->execute($com . '"Heath Cemetary" WHERE location like "Heath%"');        $this->execute($com . '"The Heorot Pub & Draught House" WHERE id="1851" OR location like "Heorot%" OR location like "The Heorot%"');        $this->execute($com . '"Innovation Connector", ' . $loc . '="Room 114" WHERE id="157"');        $this->execute($com . '"Innovation Connector" WHERE id="3747" OR id="4974"');        $this->execute($com . '"Kennedy Public Library" WHERE id="1854"');        $this->execute($com . '"' . $mun . ' Mall", ' . $loc . '="Macy\'s" WHERE location="Macy\'s - ' . $mun . ' Mall"');        $this->execute($com . '"' . $mun . ' Mall", ' . $loc . '="Parking Lot" WHERE id="4862"');        $this->execute($com . '"Maring-Hunt Public Library" WHERE location like "Maring%"');        $this->execute($com . '"McCulloch Park" WHERE location like "McCullo%"');        $this->execute($com . '"' . $min . '", ' . $loc . '="The Lawn" WHERE location="Minnestrista"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Oakhurst Gardens" WHERE location="' . $min . ' Oakhurst Gardens"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Oakhurst Mansion" WHERE id="4216"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Orchard Shop" WHERE location="' . $min . ' Orchard Shop"');        $this->execute($com . '"' . $min . '" WHERE location="' . $min . ' Center"');        $this->execute($com . '"' . $min . '" WHERE location="' . $min . ' Cultural Center"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Outdoor Stage" WHERE id="4137"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Indiana Room" WHERE id="1174"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Outside the Orchard Shop" WHERE location="' . $min . ' (outside the Orchard Shop)"');        $this->execute($com . '"Motivate Our Minds" WHERE location="MOMS"');        $this->execute($com . '"' . $mun . ' Area Career Center", ' . $loc . '="President\'s Room" WHERE id="32"');        $this->execute($com . '"' . $mun . ' Central High School", ' . $loc . '="Auditorium" WHERE id="3120" OR id="156"');        $this->execute($com . '"' . $mun . ' Civic Theatre", ' . $loc . '="Main Stage" WHERE location="' . $mun . ' Civic Theatre Main Stage"');        $this->execute($com . '"' . $mun . ' Civic Theatre" WHERE location="' . $mun . ' Civic Theater"');        $this->execute($com . '"Northside Middle School" WHERE location like "Northside Middle School%"');        $this->execute($com . '"Southside High School", ' . $loc . '="Cafeteria" WHERE id="31"');        $this->execute($com . '"St. Lawrence Catholic Church", ' . $loc . '="West Side of St. Lawrence/Inspire Academy Building" WHERE id="4350"');        $this->execute($com . '"Westside Park" WHERE id="4350" OR location="West Side Park" OR location="Westside Park in ' . $mun . '"');        $this->execute($com . '"Westview Elementary School" WHERE location like "West View Elementary%"');        $this->execute($com . '"Washington Street Festival" WHERE id="4142"');        $this->execute($com . '"Valhalla" WHERE location like "The Valhalla%" OR location like "Valhalla%"');        $this->execute($com . '"Vera Mae\'s Bistro" WHERE id="2457"');        $this->execute($com . '"YWCA", ' . $loc . '="Community Room" WHERE id="2319"');        $this->execute($com . '"YWCA Women\'s Shelter" WHERE id="4767" OR id="4849"');        $this->execute($com . '"Yorktown Middle School", ' . $loc . '="Gym" WHERE id="4692"');        $this->execute('UPDATE events SET ' . $loc . '="Cafeteria" WHERE id="34"');        // ivy tech things        $this->execute($com . '"Fisher Building, Ivy Tech", ' . $loc . '="Auditorium" WHERE id="4448" OR id="4435"');                $bsu = 'Ball State University';        // oh wow, here's all the different ways ppl have learned to enter BSU buildings over the years        $aj = 'Art and Journalism Building, ';        $ajAd = '1001 N. McKinley Ave.';        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 101", address="' . $ajAd . '" WHERE id="1011"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 125", address="' . $ajAd . '" WHERE id="962" OR id="457"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 175", address="' . $ajAd . '" WHERE location like "AJ 175%" OR location="Art and Journalism Building, ' . $bsu . ' Room 175" OR location="Art and Journalism Building, ' . $bsu . ' room 175" OR location="The Art and Journalism Building, ' . $bsu . ', room 175" OR location="' . $bsu . ' AJ175" OR location="' . $bsu . ', AJ 175" OR location="Arts & Journalism Building room 175" OR location="Arts & Journalism Building Room 175" OR location="The Art and Journalism Building, room 175" OR id="1167" OR id="2294" OR id="3355"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 225", address="' . $ajAd . '" WHERE location="Art and Journalism Building, ' . $bsu . ' Room 225" OR location="' . $bsu . ', AJ 225" OR id="301" OR id="3594" OR id="3930" OR id="458"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 289", address="' . $ajAd . '" WHERE id="1219"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Atrium", address="' . $ajAd . '" WHERE location="' . $bsu . ' Atrium" OR location like "The Atrium%"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Atrium Gallery", address="' . $ajAd . '" WHERE id="3635" OR location="The Atrium Gallery"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Atrium Patio", address="' . $ajAd . '" WHERE id="1292"');        $this->execute($com . '"Architecture Building, ' . $bsu . '", ' . $loc . '="Room 100" WHERE id="183" OR id="1562" OR id="1289"');        $mus = 'Museum of Art, ';        $this->execute($com . '"' . $mus . $bsu . '", ' . $loc . '="Room 217" WHERE location="Art Museum Room 217, ' . $bsu . '"');        $this->execute($com . '"' . $mus . $bsu . '" WHERE id="129" OR id="158" OR location="Ball State Museum of Art" OR location="' . $bsu . ' Museum of Art" OR location="Museum of Art, ' . $bsu . ', ' . $bsu . '" OR location="Museum of Art, ' . $bsu . ', Fine Arts Building" OR location like "David Owsley Museum of Art%"');        $this->execute($com . '"' . $mus . $bsu . '", ' . $loc . '="Recital Hall" WHERE id="1490" OR id="1709"');        $this->execute($com . '"' . $mus . $bsu . '", ' . $loc . '="Brown Study Room" WHERE id="1113"');        $this->execute($com . '"Arts Terrace, ' . $bsu . '", address="2021 Riverside Ave." WHERE location="BSU Arts Terrace" OR location="' . $bsu . ' Arts Terrace"');        $bra = 'Bracken Library, ';        $this->execute($com . '"' . $bra . $bsu . '", ' . $loc . '="Room 104" WHERE id="94" OR id="259" OR id="281" OR id="1714" or id="335"');        $this->execute($com . '"' . $bra . $bsu . '", ' . $loc . '="Room 201" WHERE id="695" OR id="427"');        $this->execute($com . '"' . $bra . $bsu . '", ' . $loc . '="Room 215" WHERE id="1166"');        $this->execute($com . '"' . $bra . $bsu . '" WHERE location="Bracken Library"');        $bur = 'Burkhardt Building, ';        $this->execute($com . '"' . $bur . $bsu . '", ' . $loc . '="Room 220" WHERE location like "Burkhardt Building r%" OR location like "Burkhardt building r%"');        $this->execute($com . '"' . $bur . $bsu . '", ' . $loc . '="Room 109" WHERE id="1725"');        $this->execute($com . '"' . $bur . $bsu . '" WHERE id="950" OR id="949"');        $this->execute($com . '"' . $bur . $bsu . '", ' . $loc . '="Room 108" WHERE id="331" OR id="332"');        $this->execute($com . '"Cooper Physical Science Building, ' . $bsu . '", ' . $loc . '="Room 160" WHERE id="1291"');        $this->execute($com . '"Music Instruction Building, ' . $bsu . '", ' . $loc . '="Room 152" WHERE id="250"');        $this->execute($com . '"Music Instruction Building, ' . $bsu . '" WHERE id="3359" OR id="3371"');        $this->execute($com . '"Sursa Hall, ' . $bsu . '" WHERE id="1164" OR location like "Sursa Performance Hall%" OR location like "Sursa Hall%"');        $this->execute($com . '"Worthen Arena, ' . $bsu . '", ' . $loc . '="Lounge" WHERE id="1290"');        $this->execute($com . '"Worthen Arena, ' . $bsu . '" WHERE id="4449" OR id="501" OR location="Worthen Arena"');        $this->execute($com . '"Varsity Softball Complex, ' . $bsu . '" WHERE title="BSU Women\'s Softball" OR title="Ball State Women\'s Softball"');        $this->execute($com . '"Anthony Recreation Fields, ' . $bsu . '" WHERE title="Ball State Women\'s Soccer"');        $this->execute($com . '"Briner Sports Complex, ' . $bsu . '" WHERE title="Ball State Field Hockey"');        $this->execute($com . '"Aquatic Center, ' . $bsu . '" WHERE id="4316" OR title like "%Swim and Dive"');        $this->execute($com . '"Frog Baby, ' . $bsu . '" WHERE id="2207"');        $this->execute($com . '"LaFollette Field, ' . $bsu . '" WHERE id="438" OR id="3839" OR id="4539"');        $this->execute($com . '"Letterman Building, ' . $bsu . '", ' . $loc . '="Room 125" WHERE id="1298" OR id="1102" OR id="526" OR id="3325" OR id="184" OR id="109" OR location="Ball State, LB 125"');        $this->execute($com . '"Ball Gymnasium, ' . $bsu . '" WHERE id="4118"');        $this->execute($com . '"Strother Theatre, ' . $bsu . '" WHERE location like "Strother%"');        $this->execute($com . '"Alumni Center, ' . $bsu . '", ' . $loc . '="Meeting Room 1" WHERE id="1497" OR id="2967" OR id="3861"');        $this->execute($com . '"University Green, ' . $bsu . '" WHERE id="151" OR id="1314"');        $this->execute($com . '"University Theatre, ' . $bsu . '" WHERE location="University Theatre"');        $this->execute($com . '"North Quad, ' . $bsu . '", ' . $loc . '="Room 039" WHERE id="1721"');        $this->execute($com . '"North Quad, ' . $bsu . '", ' . $loc . '="On the Green" WHERE id="2325" OR id="2326"');        $this->execute($com . '"The Quad, ' . $bsu . '", ' . $loc . '="" WHERE id="1974" OR id="4712"');        $this->execute($com . '"Multicultural Center, ' . $bsu . '" WHERE id="407" OR id="1064" OR id="1076"');        $this->execute($com . '"Teachers College, ' . $bsu . '", ' . $loc . '="Room 102" WHERE id="1294"');        $this->execute($com . '"Teachers College, ' . $bsu . '", ' . $loc . '="Room 200B" WHERE id="452"');        $this->execute($com . '"Teachers College, ' . $bsu . '" WHERE id="3370"');        $this->execute($com . '"E.B. and Bertha C. Ball Center" WHERE location like "E.B.%"');        $this->execute($com . '"Pruis Hall, ' . $bsu . '" WHERE location like "Pruis Hall%"');        $this->execute($com . '"Rinard Orchid Greenhouse" WHERE location like "Rinard%"');        $stu = 'Student Center, ';        $bsc = 'BSU Student Center';        $this->execute($com . '"' . $stu . $bsu . '" WHERE id="398" OR location="' . $bsc . '" OR location="' . $bsc . ', Registration on Second Floor" OR id="2021" OR location="Ball State Student Center"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Room 310" WHERE location="' . $bsc . ' room 310" OR id="288"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Forum Room" WHERE location="' . $bsc . ', Forum Room" OR id="1176" OR location like "Student Center F%"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Room 301" WHERE location="' . $bsc . ', Room 301" OR location like "Student Center Room 301%"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Room 102" WHERE id="300"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Pineshelf Room" WHERE id="3907"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Room 303" WHERE location="' . $bsc . ', Room 303" OR id="1162"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Rooms 310A & B" WHERE location="' . $bsc . ', Rooms 310A and B"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Outside" WHERE id="2049"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Ballroom" WHERE id="2234" OR id="2235" OR id="1073" OR location like "Student Center B%"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Ballroom", description="View this wonderful event for the little girl in your life at www.ballstatesports.com/gymnastics" WHERE id="1690"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Cardinal Hall" WHERE id="1675" OR id="1717"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="The Tally" WHERE location="Student Center Tally"');        $this->execute($com . '"' . $bsu . ' (General)" WHERE id="1300"');        // general location names...        $this->execute($com . '"Multiple locations" WHERE id="4276" OR id="4554" OR id="1116" OR id="1117" OR series_id="275" OR id="3235" OR id="4991" OR id="4858" OR id="4276" OR id="4554" OR location like "Downtown and the Ball State%"');        $this->execute($com . '"To be determined" WHERE id="3483"');        // here are events that are not in ' . $mun . '        $this->execute('DELETE FROM events WHERE id="4765" OR id="154"');        $this->execute('DELETE FROM events WHERE location="Stable Studios"');        $events            ->addColumn('location_slug', 'string', ['after' => '' . $loc . '', 'limit' => 20, 'null' => false])            ->save();        $stmt = $this->query('SELECT * FROM events');        $events = $stmt->fetchAll();        foreach ($events as $event) {            $id = $event['id'];            $location = trim($event['location']);            $locationSlug = strtolower($event['location']);            $locationSlug = substr($locationSlug, 0, 20);            $locationSlug = str_replace('/', ' ', $locationSlug);            $locationSlug = preg_replace("/[^A-Za-z0-9 ]/", '', $locationSlug);            $locationSlug = str_replace("   ", ' ', $locationSlug);            $locationSlug = str_replace("  ", ' ', $locationSlug);            $locationSlug = str_replace(' ', '-', $locationSlug);            if (substr($locationSlug, -1) == '-') {                $locationSlug = substr($locationSlug, 0, -1);            }            $this->execute($com . '"' . $location . '", location_slug="' . $locationSlug . '" WHERE id="' . $id . '"');        }    }    /**     * Change Method.     *     * More information on this method is available here:     * http://docs.phinx.org/en/latest/migrations.html#the-change-method     * @return void     */    public function down()    {        $events = $this->table('events');        $events            ->removeColumn('location_slug')            ->save();    }}