<?php// @codingStandardsIgnoreFileuse Migrations\AbstractMigration;class CreatingLocationSlugForEvents extends AbstractMigration{    /**     * Change Method.     *     * More information on this method is available here:     * http://docs.phinx.org/en/latest/migrations.html#the-change-method     * @return void     */    public function up()    {        $events = $this->table('events');        $events->changeColumn('location', 'string', ['limit' => 100]);        // clean up errors in inputting locations        // common strings, locations, commands etc.        $add = 'address="';        $aj = 'Art and Journalism Building, ';        $ajAd = '1001 N. McKinley Ave.';        $bra = 'Bracken Library, ';        $bsc = 'BSU Student Center';        $bsu = 'Ball State University';        $bur = 'Burkhardt Building, ';        $com = 'UPDATE events SET location=';        $del = 'Delaware County';        $like = 'location like';        $loc = 'location_details';        $min = 'Minnetrista';        $mun = 'Muncie';        $mus = 'Museum of Art, ';        $orLo = ' OR location="';        $stu = 'Student Center, ';        $whe = 'WHERE location="';        $whId = 'WHERE id="';        // locations around town        $this->execute('UPDATE events SET ' . $loc . '="Music Room", location="Cornerstone Center for the Arts" ' . $whId . '5"');        $this->execute($com . '"The Mark III Tap Room", ' . $add . '306 S. Walnut St." ' . $whId . '1130"' . $orLo . 'The Mark III Taproom"');        $this->execute($com . '"Northside Church of the Nazarene", ' . $add . '3801 N. Wheeling Ave." ' . $whId . '4691"');        $this->execute($com . '"Be Here Now", ' . $add . '505 N. Dill St." ' . $whId . '2853"');        $this->execute($com . '"Cornerstone Center for the Arts", ' . $add . '520 E. Main St." ' . $whId . '4561"');        $this->execute($com . '"Lotus Yoga Studio", ' . $add . '814 W. White River Blvd." ' . $whId . '4116"');        $this->execute($com . '"AMC Showplace ' . $mun . ' 12" ' . $whId . '3421"');        $this->execute($com . '"Ball Memorial Hospital", ' . $loc . '="Auditorium" ' . $whId . '30"');        $this->execute($com . '"Ball Memorial Hospital", ' . $loc . '="South Tower, John Fisher Heart Center lounge" ' . $whId . '2163"');        $this->execute($com . '"Big Shots Pub" ' . $whId . '3746"');        $this->execute($com . '"Blue Bottle Coffee Shop", ' . $loc . '="Parking Lot" ' . $whId . '559"');        $this->execute($com . '"Canan Commons", ' . $loc . '="Band Shell" ' . $whe . 'Canan Commons Band Shell"');        $this->execute($com . '"Canan Commons" WHERE ' . $like . ' "Canan Commons%"' . $orLo . 'Canon Commons"');        $this->execute($com . '"Cardinal Greenway Depot/Trail" WHERE ' . $like . ' "Cardinal Greenway Depot%"' . $orLo . 'Cardinal Greenways, Wysor Street Depot"' . $orLo . 'Historic Wysor St. Depot"');        $this->execute($com . '"Carnegie Public Library" WHERE ' . $like . ' "Carnegie Library%"');        $this->execute($com . '"Connection Corner" ' . $whId . '4362"');        $this->execute($com . '"Cornerstone Center for the Arts" ' . $whId . '89" OR id="4355"');        $this->execute($com . '"Cornerstone Park", ' . $loc . '="Corner of Main St. and Madison" ' . $whId . '3978"');        $this->execute($com . '"' . $del . ' Building" ' . $whId . '1175"');        $this->execute($com . '"' . $del . ' Fairgrounds", ' . $loc . '="Community Building" ' . $whId . '1563"');        $this->execute($com . '"' . $del . ' Fairgrounds", ' . $loc . '="Through DWNTWN" ' . $whId . '4169"');        $this->execute($com . '"' . $del . ' Fairgrounds", ' . $loc . '="Memorial Building" ' . $whId . '1693"');        $this->execute($com . '"' . $del . ' Fairgrounds" ' . $whe . $del . ' Fair Grounds"');        $this->execute($com . '"Downtown", ' . $loc . '="Old National Lot" ' . $whId . '2291" OR id="3032"' . $orLo . 'Downtown ' . $mun . '"');        $this->execute($com . '"Elm Street Brewing Company" ' . $whe . 'Elm Street Brew Pub"');        $this->execute($com . '"Elm Street Brewing Company" ' . $whe . 'Elm Street Brewing Company."');        $this->execute($com . '"Full Circle Arts Co-op" WHERE ' . $like . ' "Full Circle Arts Co-op%"');        $this->execute($com . '"Gallery 308" ' . $whe . 'GALLERY 308"');        $this->execute($com . '"Gibson Roller Skating Arena" WHERE ' . $like . ' "Gibson%"');        $this->execute($com . '"Glick Center for Glass" WHERE ' . $like . ' "Glick%"');        $this->execute($com . '"Heath Cemetary" WHERE ' . $like . ' "Heath%"');        $this->execute($com . '"The Heorot Pub & Draught House" ' . $whId . '1851" OR ' . $like . ' "Heorot%" OR ' . $like . ' "The Heorot%"');        $this->execute($com . '"Innovation Connector", ' . $loc . '="Room 114" ' . $whId . '157"');        $this->execute($com . '"Innovation Connector" ' . $whId . '3747" OR id="4974"');        $this->execute($com . '"Kennedy Public Library" ' . $whId . '1854"');        $this->execute($com . '"' . $mun . ' Mall", ' . $loc . '="Macy\'s" ' . $whe . 'Macy\'s - ' . $mun . ' Mall"');        $this->execute($com . '"' . $mun . ' Mall", ' . $loc . '="Parking Lot" ' . $whId . '4862"');        $this->execute($com . '"Maring-Hunt Public Library" WHERE ' . $like . ' "Maring%"');        $this->execute($com . '"McCulloch Park" WHERE ' . $like . ' "McCullo%"');        $this->execute($com . '"' . $min . '", ' . $loc . '="The Lawn" ' . $whe . 'Minnestrista"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Oakhurst Gardens" ' . $whe . $min . ' Oakhurst Gardens"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Oakhurst Mansion" ' . $whId . '4216"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Orchard Shop" ' . $whe . $min . ' Orchard Shop"');        $this->execute($com . '"' . $min . '" ' . $whe . $min . ' Center"');        $this->execute($com . '"' . $min . '" ' . $whe . $min . ' Cultural Center"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Outdoor Stage" ' . $whId . '4137"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Indiana Room" ' . $whId . '1174"');        $this->execute($com . '"' . $min . '", ' . $loc . '="Outside the Orchard Shop" ' . $whe . $min . ' (outside the Orchard Shop)"');        $this->execute($com . '"Motivate Our Minds" ' . $whe . 'MOMS"');        $this->execute($com . '"' . $mun . ' Area Career Center", ' . $loc . '="President\'s Room" ' . $whId . '32"');        $this->execute($com . '"' . $mun . ' Central High School", ' . $loc . '="Auditorium" ' . $whId . '3120" OR id="156"');        $this->execute($com . '"' . $mun . ' Civic Theatre", ' . $loc . '="Main Stage" ' . $whe . $mun . ' Civic Theatre Main Stage"');        $this->execute($com . '"' . $mun . ' Civic Theatre" ' . $whe . $mun . ' Civic Theater"');        $this->execute($com . '"Northside Middle School" WHERE ' . $like . ' "Northside Middle School%"');        $this->execute($com . '"Southside High School", ' . $loc . '="Cafeteria" ' . $whId . '31"');        $this->execute($com . '"St. Lawrence Catholic Church", ' . $loc . '="West Side of St. Lawrence/Inspire Academy Building" ' . $whId . '4350"');        $this->execute($com . '"Westside Park" ' . $whId . '4350"' . $orLo . 'West Side Park"' . $orLo . 'Westside Park in ' . $mun . '"');        $this->execute($com . '"Westview Elementary School" WHERE ' . $like . ' "West View Elementary%"');        $this->execute($com . '"Washington Street Festival" ' . $whId . '4142"');        $this->execute($com . '"Valhalla" WHERE ' . $like . ' "The Valhalla%" OR ' . $like . ' "Valhalla%"');        $this->execute($com . '"Vera Mae\'s Bistro" ' . $whId . '2457"');        $this->execute($com . '"YWCA", ' . $loc . '="Community Room" ' . $whId . '2319"');        $this->execute($com . '"YWCA Women\'s Shelter" ' . $whId . '4767" OR id="4849"');        $this->execute($com . '"Yorktown Middle School", ' . $loc . '="Gym" ' . $whId . '4692"');        $this->execute('UPDATE events SET ' . $loc . '="Cafeteria" ' . $whId . '34"');        // ivy tech things        $this->execute($com . '"Fisher Building, Ivy Tech", ' . $loc . '="Auditorium" ' . $whId . '4448" OR id="4435"');        // oh wow, here's all the different ways ppl have learned to enter BSU buildings over the years        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 101", ' . $add . $ajAd . '" ' . $whId . '1011"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 125", ' . $add . $ajAd . '" ' . $whId . '962" OR id="457"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 175", ' . $add . $ajAd . '" WHERE ' . $like . ' "AJ 175%"' . $orLo . 'Art and Journalism Building, ' . $bsu . ' Room 175"' . $orLo . 'Art and Journalism Building, ' . $bsu . ' room 175"' . $orLo . 'The Art and Journalism Building, ' . $bsu . ', room 175"' . $orLo . '' . $bsu . ' AJ175"' . $orLo . '' . $bsu . ', AJ 175"' . $orLo . 'Arts & Journalism Building room 175"' . $orLo . 'Arts & Journalism Building Room 175"' . $orLo . 'The Art and Journalism Building, room 175" OR id="1167" OR id="2294" OR id="3355"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 225", ' . $add . $ajAd . '" ' . $whe . 'Art and Journalism Building, ' . $bsu . ' Room 225"' . $orLo . '' . $bsu . ', AJ 225" OR id="301" OR id="3594" OR id="3930" OR id="458"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Room 289", ' . $add . $ajAd . '" ' . $whId . '1219"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Atrium", ' . $add . $ajAd . '" ' . $whe . $bsu . ' Atrium" OR ' . $like . ' "The Atrium%"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Atrium Gallery", ' . $add . $ajAd . '" ' . $whId . '3635"' . $orLo . 'The Atrium Gallery"');        $this->execute($com . '"' . $aj . $bsu . '", ' . $loc . '="Atrium Patio", ' . $add . $ajAd . '" ' . $whId . '1292"');        $this->execute($com . '"Architecture Building, ' . $bsu . '", ' . $loc . '="Room 100" ' . $whId . '183" OR id="1562" OR id="1289"');        $this->execute($com . '"' . $mus . $bsu . '", ' . $loc . '="Room 217" ' . $whe . 'Art Museum Room 217, ' . $bsu . '"');        $this->execute($com . '"' . $mus . $bsu . '" ' . $whId . '129" OR id="158"' . $orLo . 'Ball State Museum of Art"' . $orLo . '' . $bsu . ' Museum of Art"' . $orLo . 'Museum of Art, ' . $bsu . ', ' . $bsu . '"' . $orLo . 'Museum of Art, ' . $bsu . ', Fine Arts Building" OR ' . $like . ' "David Owsley Museum of Art%"');        $this->execute($com . '"' . $mus . $bsu . '", ' . $loc . '="Recital Hall" ' . $whId . '1490" OR id="1709"');        $this->execute($com . '"' . $mus . $bsu . '", ' . $loc . '="Brown Study Room" ' . $whId . '1113"');        $this->execute($com . '"Arts Terrace, ' . $bsu . '", ' . $add . '2021 Riverside Ave." ' . $whe . 'BSU Arts Terrace"' . $orLo . '' . $bsu . ' Arts Terrace"');        $this->execute($com . '"' . $bra . $bsu . '", ' . $loc . '="Room 104" ' . $whId . '94" OR id="259" OR id="281" OR id="1714" or id="335"');        $this->execute($com . '"' . $bra . $bsu . '", ' . $loc . '="Room 201" ' . $whId . '695" OR id="427"');        $this->execute($com . '"' . $bra . $bsu . '", ' . $loc . '="Room 215" ' . $whId . '1166"');        $this->execute($com . '"' . $bra . $bsu . '" ' . $whe . 'Bracken Library"');        $this->execute($com . '"' . $bur . $bsu . '", ' . $loc . '="Room 220" WHERE ' . $like . ' "Burkhardt Building r%" OR ' . $like . ' "Burkhardt building r%"');        $this->execute($com . '"' . $bur . $bsu . '", ' . $loc . '="Room 109" ' . $whId . '1725"');        $this->execute($com . '"' . $bur . $bsu . '" ' . $whId . '950" OR id="949"');        $this->execute($com . '"' . $bur . $bsu . '", ' . $loc . '="Room 108" ' . $whId . '331" OR id="332"');        $this->execute($com . '"Cooper Physical Science Building, ' . $bsu . '", ' . $loc . '="Room 160" ' . $whId . '1291"');        $this->execute($com . '"Music Instruction Building, ' . $bsu . '", ' . $loc . '="Room 152" ' . $whId . '250"');        $this->execute($com . '"Music Instruction Building, ' . $bsu . '" ' . $whId . '3359" OR id="3371"');        $this->execute($com . '"Sursa Hall, ' . $bsu . '" ' . $whId . '1164" OR ' . $like . ' "Sursa Performance Hall%" OR ' . $like . ' "Sursa Hall%"');        $this->execute($com . '"Worthen Arena, ' . $bsu . '", ' . $loc . '="Lounge" ' . $whId . '1290"');        $this->execute($com . '"Worthen Arena, ' . $bsu . '" ' . $whId . '4449" OR id="501"' . $orLo . 'Worthen Arena"');        $this->execute($com . '"Varsity Softball Complex, ' . $bsu . '" WHERE title="BSU Women\'s Softball" OR title="Ball State Women\'s Softball"');        $this->execute($com . '"Anthony Recreation Fields, ' . $bsu . '" WHERE title="Ball State Women\'s Soccer"');        $this->execute($com . '"Briner Sports Complex, ' . $bsu . '" WHERE title="Ball State Field Hockey"');        $this->execute($com . '"Aquatic Center, ' . $bsu . '" ' . $whId . '4316" OR title like "%Swim and Dive"');        $this->execute($com . '"Frog Baby, ' . $bsu . '" ' . $whId . '2207"');        $this->execute($com . '"LaFollette Field, ' . $bsu . '" ' . $whId . '438" OR id="3839" OR id="4539"');        $this->execute($com . '"Letterman Building, ' . $bsu . '", ' . $loc . '="Room 125" ' . $whId . '1298" OR id="1102" OR id="526" OR id="3325" OR id="184" OR id="109"' . $orLo . 'Ball State, LB 125"');        $this->execute($com . '"Ball Gymnasium, ' . $bsu . '" ' . $whId . '4118"');        $this->execute($com . '"Strother Theatre, ' . $bsu . '" WHERE ' . $like . ' "Strother%"');        $this->execute($com . '"Alumni Center, ' . $bsu . '", ' . $loc . '="Meeting Room 1" ' . $whId . '1497" OR id="2967" OR id="3861"');        $this->execute($com . '"University Green, ' . $bsu . '" ' . $whId . '151" OR id="1314"');        $this->execute($com . '"University Theatre, ' . $bsu . '" ' . $whe . 'University Theatre"');        $this->execute($com . '"North Quad, ' . $bsu . '", ' . $loc . '="Room 039" ' . $whId . '1721"');        $this->execute($com . '"North Quad, ' . $bsu . '", ' . $loc . '="On the Green" ' . $whId . '2325" OR id="2326"');        $this->execute($com . '"The Quad, ' . $bsu . '", ' . $loc . '="" ' . $whId . '1974" OR id="4712"');        $this->execute($com . '"Multicultural Center, ' . $bsu . '" ' . $whId . '407" OR id="1064" OR id="1076"');        $this->execute($com . '"Teachers College, ' . $bsu . '", ' . $loc . '="Room 102" ' . $whId . '1294"');        $this->execute($com . '"Teachers College, ' . $bsu . '", ' . $loc . '="Room 200B" ' . $whId . '452"');        $this->execute($com . '"Teachers College, ' . $bsu . '" ' . $whId . '3370"');        $this->execute($com . '"E.B. and Bertha C. Ball Center" WHERE ' . $like . ' "E.B.%"');        $this->execute($com . '"Pruis Hall, ' . $bsu . '" WHERE ' . $like . ' "Pruis Hall%"');        $this->execute($com . '"Rinard Orchid Greenhouse" WHERE ' . $like . ' "Rinard%"');        $this->execute($com . '"' . $stu . $bsu . '" ' . $whId . '398"' . $orLo . '' . $bsc . '"' . $orLo . '' . $bsc . ', Registration on Second Floor" OR id="2021"' . $orLo . 'Ball State Student Center"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Room 310" ' . $whe . $bsc . ' room 310" OR id="288"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Forum Room" ' . $whe . $bsc . ', Forum Room" OR id="1176" OR ' . $like . ' "Student Center F%"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Room 301" ' . $whe . $bsc . ', Room 301" OR ' . $like . ' "Student Center Room 301%"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Room 102" ' . $whId . '300"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Pineshelf Room" ' . $whId . '3907"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Room 303" ' . $whe . $bsc . ', Room 303" OR id="1162"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Rooms 310A & B" ' . $whe . $bsc . ', Rooms 310A and B"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Outside" ' . $whId . '2049"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Ballroom" ' . $whId . '2234" OR id="2235" OR id="1073" OR ' . $like . ' "Student Center B%"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Ballroom", description="View this wonderful event for the little girl in your life at www.ballstatesports.com/gymnastics" ' . $whId . '1690"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="Cardinal Hall" ' . $whId . '1675" OR id="1717"');        $this->execute($com . '"' . $stu . $bsu . '", ' . $loc . '="The Tally" ' . $whe . 'Student Center Tally"');        $this->execute($com . '"' . $bsu . ' (General)" ' . $whId . '1300"');        // general location names...        $this->execute($com . '"Multiple locations" ' . $whId . '4276" OR id="4554" OR id="1116" OR id="1117" OR series_id="275" OR id="3235" OR id="4991" OR id="4858" OR id="4276" OR id="4554" OR ' . $like . ' "Downtown and the Ball State%"');        $this->execute($com . '"To be determined" ' . $whId . '3483"');        // here are events that are not in ' . $mun . '        $this->execute('DELETE FROM events ' . $whId . '4765" OR id="154"');        $this->execute('DELETE FROM events ' . $whe . 'Stable Studios"');        $events            ->addColumn('location_slug', 'string', ['after' => '' . $loc . '', 'limit' => 20, 'null' => false])            ->save();        $stmt = $this->query('SELECT * FROM events');        $events = $stmt->fetchAll();        foreach ($events as $event) {            $id = $event['id'];            $location = trim($event['location']);            $locationSlug = strtolower($event['location']);            $locationSlug = substr($locationSlug, 0, 20);            $locationSlug = str_replace('/', ' ', $locationSlug);            $locationSlug = preg_replace("/[^A-Za-z0-9 ]/", '', $locationSlug);            $locationSlug = str_replace("   ", ' ', $locationSlug);            $locationSlug = str_replace("  ", ' ', $locationSlug);            $locationSlug = str_replace(' ', '-', $locationSlug);            if (substr($locationSlug, -1) == '-') {                $locationSlug = substr($locationSlug, 0, -1);            }            $this->execute($com . '"' . $location . '", location_slug="' . $locationSlug . '" ' . $whId . $id . '"');        }    }    /**     * Change Method.     *     * More information on this method is available here:     * http://docs.phinx.org/en/latest/migrations.html#the-change-method     * @return void     */    public function down()    {        $events = $this->table('events');        $events            ->removeColumn('location_slug')            ->save();    }}